import pandas as pd
import numpy as np

# User Params
predDir = r"D:\PhD\YieldProject\Output_Detrended\Predictions"

# First, combine predictions from all weeks into one df
df = pd.read_csv(predDir + "//Predictions_Wheat_Week18.csv")
df = df.rename(columns={'PredMean_Week18': 'PredMean', 'PredStd_Week18': 'PredStd'})
weeks = list(range(19, 39)) # All weeks except 18 which is already loaded
for week in weeks:
    str_week = str(week)
    df_week = pd.read_csv(predDir + f"//Predictions_Wheat_Week{str_week}.csv")
    # Remove any other weeks other than the week of interest
    excl_cols1 = [col for col in df_week.columns if not (col.startswith('PredMean_') and not col.endswith(str_week))]
    excl_cols2 = [col for col in df_week.columns if (col.startswith('PredStd_') and not col.endswith(str_week))]
    excl_cols = excl_cols1 + excl_cols2
    df_week = df_week[excl_cols]
    df.loc[df['Week'] == week, 'PredMean'] = df_week[f'PredMean_Week{str_week}'].dropna()
    df.loc[df['Week'] == week, 'PredStd'] = df_week[f'PredStd_Week{str_week}'].dropna()
df.to_csv(predDir + "//AllPredictions.csv", index = False)
